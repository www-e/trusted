| schemaname | tablename | policyname                        | permissive | roles           | cmd    | qual                                                                                                                                         | with_check                                                                                             |
| ---------- | --------- | --------------------------------- | ---------- | --------------- | ------ | -------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------ |
| public     | users     | users_read_own                    | PERMISSIVE | {public}        | SELECT | (auth.uid() = id)                                                                                                                            | null                                                                                                   |
| public     | users     | admin_read_all                    | PERMISSIVE | {public}        | SELECT | is_admin()                                                                                                                                   | null                                                                                                   |
| public     | users     | admin_update_all                  | PERMISSIVE | {public}        | UPDATE | is_admin()                                                                                                                                   | null                                                                                                   |
| public     | users     | users_insert_own                  | PERMISSIVE | {authenticated} | INSERT | null                                                                                                                                         | (auth.uid() = id)                                                                                      |
| public     | users     | users_update_own                  | PERMISSIVE | {authenticated} | UPDATE | (auth.uid() = id)                                                                                                                            | null                                                                                                   |
| storage    | objects   | Users can upload to their folder  | PERMISSIVE | {authenticated} | INSERT | null                                                                                                                                         | ((bucket_id = 'userphotos'::text) AND ((storage.foldername(name))[1] = ('user_'::text || auth.uid()))) |
| storage    | objects   | Users can view their own photos   | PERMISSIVE | {authenticated} | SELECT | ((bucket_id = 'userphotos'::text) AND ((storage.foldername(name))[1] = ('user_'::text || auth.uid())))                                       | null                                                                                                   |
| storage    | objects   | Users can update their own photos | PERMISSIVE | {authenticated} | UPDATE | ((bucket_id = 'userphotos'::text) AND ((storage.foldername(name))[1] = ('user_'::text || auth.uid())))                                       | null                                                                                                   |
| storage    | objects   | Users can delete their own photos | PERMISSIVE | {authenticated} | DELETE | ((bucket_id = 'userphotos'::text) AND ((storage.foldername(name))[1] = ('user_'::text || auth.uid())))                                       | null                                                                                                   |
| storage    | objects   | Admins can view all photos        | PERMISSIVE | {authenticated} | SELECT | ((bucket_id = 'userphotos'::text) AND (EXISTS ( SELECT 1
   FROM users
  WHERE ((users.id = auth.uid()) AND (users.role = 'admin'::text))))) | null                                                                                                   |
| storage    | objects   | Admins can manage all photos      | PERMISSIVE | {authenticated} | ALL    | ((bucket_id = 'userphotos'::text) AND (EXISTS ( SELECT 1
   FROM users
  WHERE ((users.id = auth.uid()) AND (users.role = 'admin'::text))))) | null                                                                                                   |
| storage    | objects   | Fallback upload policy            | PERMISSIVE | {authenticated} | INSERT | null                                                                                                                                         | (bucket_id = 'userphotos'::text)                                                                       |
| public     | users     | users_lookup_by_username          | PERMISSIVE | {public}        | SELECT | true                                                                                                                                         | null                                                                                                   |